---
title: '자바스크립트 빌드 툴과 SWC 이해하기'
date: 2023-10-01
description: '빌드툴과 SWC 이해하기'
thumbnail: './thumbnail.png'
category: 'javascript'
---

## 1. 바벨 (Babel)

바벨은 자바스크립트 개발자가 최신 자바스크립트 문법을 사용하는 중요한 빌드툴이다.

바벨은 자바스크립트 빌드 툴 중 트랜스파일러 (Transpiler) 라는 영역에 속한다는 것을 알 수 있다.

### 1-1. 컴파일러 (Compiler)

우리는 컴퓨터가 0과 1만을 이해할 수 있다는 사실을 알고 있다. (0과 1로만 작성된 언어는 기계어이다.) 하지만 컴퓨터에서 동작할 어떤 프로그램을 구현할 때, 프로그래머는 0과 1로 프로그램을 작성하는 것이 아니라 자바스크립트나 C++ 과 같은 프로그래밍 언어를 사용해 프로그램을 작성한다.

대부분 프로그래밍 언어는 영어와 같이 사람이 실제로 사용하는 언어를 기준으로, 사람이 이해하기 쉬운 단어와 문법을 통해 프로그램을 작성할 수 있도록 설계되어 있다. 이런 언어들을 사람이 이해하기 쉽도록 추상화가 많이 되어있다 라는 의미를 담아 고급 프로그래밍 언어라고 부른다.

이러한 자바스크립트와 같은 고급 프로그래밍 언어로 짜인 코드를 컴퓨터에 바로 집어넣는다고 해서 컴퓨터가 우리의 코드를 이해하고 실행할 수 있는 것은 아니다. 컴퓨터에 우리가 작성한 코드를 이해시키기 위해서는, 컴퓨터가 이해하는 기계어와 1 대 1로 대응되는 저급 프로그래밍언어로 번역하는 과정이 필요하다. 마치 영어는 모르는 사람을 위해 영어를 한국어로 번역해주는 것처럼 말이다.

우리는 **프로그래밍의 영역에서 이러한 언어 간의 변역을 담당하는 번역기를 컴파일러**라고 부른다.

**한 언어의 코드로 변환해주는 역할만 제공한다면 그 소프트웨어는 컴파일러 라고 할 수 있다.**

### 1-2. 트랜스파일러 (Transpiler)

트랜스파일러는 위에서 설명한 컴파일러의 하위분류이다. 언어를 변환해 주는 기능을 제공하는 소프트웨어인 것은 일반적인 컴파일러와 동일하지만, 트랜스파일러는 완전히 다른 두 언어 사이를 변환해 주는 것이 아니라 유사한 두 언어 사이에서 변환 해주는 역할을 제공해 주는 소프트웨어라는 점이 다르다.

트랜스파일러는 옛 우리말을 현대 한국어로 번역해 주는 번역기라고 할 수 있다.

**바벨이라는 툴이 트랜스파일러인 이유는, 최신 자바스크립트 문법으로 작성된 코드를 구버전 브라우저도 이해할 수 있는 수준의 오래된 자바스크립트 코드로 변환해주는 소프트웨어 이기 때문이다.** 즉, 바벨은 트랜스파일러로써 유사한 두 언어 사이에서의 변환 기능을 제공해준다.

```jsx
// ES6 문법으로 작성된 자바스크립트 코드
const HelloWorld = ({ name, content }) => {
	let fullText = ''
	if (name) {
		fullText += `name: ${name}`
	}
	if (content) {
		fullText += `name: ${content }`
	}
	return fullText
}

// 바벨의 transpiler
const HelloWorld (_ref) {
	var name = _ref.name,
		content = _ref.content
	var fullText = ""
	if (name) {
		fullText += "name: ".concat(name);
	}
	if (content) {
		fullText += "name: ".concat(content);
	}
	return fullText
}
```

변환 결과를 보면, 바벨이 우리의 코드를 IE10에서도 동작하도록 다음과 같이 변환해 줬음을 확인할 수 있다.

- let 및 const 키워드를 var로 변경
- 화살표 함수는 일반 함수로 변경
- 템플릿 리터럴을 concat 함수로 대체
- 구조 분해 할당 문법을 사용한 함수 속성을 \_ref로 대체

## 2. Terser

사실 우리가 Terser라는 툴을 직접 다룰 일은 많지 않다. 대부분의 프레임워크에서는 이미 Terser에 대한 세팅이 기본적으로 되어있으며, 더욱이 Webpack의 경우 v4이후 버전부터 별도의 설정 없이도 프로덕션 모드에서 자동으로 Terser툴을 사용하도록 세팅되어 있기 때문이다.

Terser의 공식사이트에서는 Terser라는 툴을 다음과 같이 소개한다.

ES6+를 위한 자바스크립트 parser, mangler 그리고 compressor

### 2-1. mangler

사전의 mangle 이라는 단어의 뜻을 검색해 보면, 심하게 훼손하다 혹은 엉망으로 만들다 라는 뜻을 가지고 있다는 것을 알 수 있다. 따라서 Terser가 mangler라는 뜻을 우리가 작성한 자바스크립트 코드를 훼손하거나 엉망으로 만들어 주는 툴임을 유추해 볼 수 있다.

Terser가 mangler로써 하는 역할은 우리가 코드에서 사용한 변수,함수,속성 들의 이름을 매우 단순화된 이름으로 변경해주는것이다.

우리가 어떤 언어로 프로그래밍을 하는지와 무관하게, 변수나 함수의 이름을 정할 때에는 항상 의미 있는 네이밍을 사용하라는 격언이 언제나 등장한다. 가독성을 향상시키니 말이다.

하지만, 컴퓨터 입장에서 이 네이밍은 전혀 중요하지 않다. 결과적으로 소스파일의 크기가 커질 뿐이다.

프로젝트에서 사용하는 소스코드 파일의 크기는 작으면 작을수록 좋다. 사용자가 어떤 웹 페이지에 접근하면, 브라우저는 웹 페이지의 다양한 기능들을 제공하는데 필요한 소스 파일들을 서버로부터 다운로드한다. 이때 소스 파일의 크기가 크면 클수록 다운로드에 걸리는 시간이 길어지기 때문에, 기능 제공을 위해 걸리는 시간이 더 오래 걸리게 되고 결국 나쁜 사용자 경험을 줄 수밖에 없다.

mangler는 우리의 소스코드에 존재하는 네이밍들을 의미 없는 문자로 바꿔버린다.

```jsx
// 적용 전
const HelloWorld = ({ name }) => {
  let fullText = ''
  if (name) {
    fullText += `name: ${name}`
  }
  return fullText
}
HelloWorld({ name: 'Bill' })

// 적용 후
const n = ({ name: n, content: e }) => {
  let t = ''
  if (n) {
    t += `name: ${n}`
  }

  return t
}
n({ name: 'Bill' })
```

### 2-2. compressor

compress 는 압축하다 라는 뜻을 가지고 있따. 따라서 Terser가 compressor라는 뜻은 우리가 작성한 자바스크립트 코드를 압축해 주는 툴 임을 유추해 볼 수 있다.

Compressor기능을 사용하면 다음과 같은 변경 점들이 발생한다.

```jsx
// 적용전
const HelloWorld = ({ name }) => {
  let fullText = ''
  if (name) {
    fullText += `name: ${name}`
  }
  return fullText
}

HelloWorld({ name: 'Bill' })

// 적용 후
;(({ name: name, content: content }) => {
  let fullText = ''
  name && (fullText += `name: ${name}`)
})({
  name: 'Bill'
})
```

- 함수명이 사라지고, 함수가 **`정의와 동시에 실행`**되도록 변경된다.
- if 조건문이 && 연산자로 변경된다..
- fullText에 내용을 채워 넣는 코드들이 쉼표(,)를 통해 한 줄의 코드로 변경.
- 실제로 HelloWorld 함수의 리턴 값을 사용하는 곳이 없으므로 return 문이 제거되었다..

### 2-3. Terser as Minifier

위에서 설명한 코드를 mangle하는 과정이나 compress하는 과정과 같이 우리가 작성한 코드를 동일한 기능을 제공하는 경량화된 코드로 변경해 주는 일련의 작업을 minify 혹은 minification(코드경량화) 라고 부른다. 그리고 코드 경량화 작업을 해주는 툴을 우리는 minifier라고 부른다. 따라서 Terser는 우리가 작성한 자바스크립트 코드를 프로덕션에서 더욱 경량화된 상태로 제공될 수 있도록 도와주는 minifier 빌드 툴이라고 할 수 있따.

## 3. SWC

swr는 자바스크립트 프로젝트의 컴파일과 번들링 모두에 사용될 수 있는, Rust라는 언어로 제작된 빌드 툴이다. SWC 는 Speedy Web Compiler의 약자로, 말 그대로 매우 빠른 웹 컴파일러의 기능을 제공하는 툴이다.

하지만 이름과는 달리 컴파일러의 기능만을 제공하지 않고, 웹팩과 같은 자바스크립트 번들러의 기능을 제공할 spack도 개발중이며 얼마든지 확장이 가능하도록 설계되어 있기 때문에, 단순한 컴파일러라고 보기는 어렵고, 하나의 플랫폼으로 보는게 적정하다.

### 3-1. SWC는 왜 빠를까?

Next.js에서는 SWC를 기반으로 개발한 컴파일러를 통해 기존 빌드에 활용하던 바벨과 Terser를 대체한다. 즉, Next.js의 빌드 과정 중 트랜스파일링을 수행했던 바벨과, 코드 경량화를 수행했던 Terser가 SWC로 대체된다는 뜻이다. SWC로 교체함으로써 트랜스파일링은 무려 17배나 빨라졌다고 하며, 코드 경량화 작업은 7배가 빨라졌다고 한다.

그렇다면, SWC라는 툴이나 바벨이나 Terser보다 월등하게 빠른 이유가 대체 뭘까?

가장 큰 이유는 바로 Rust라는 프로그래밍 언어가 이벤트 루프 기반의 싱글 스레드 언어인 자바스크립트와는 다르게 병렬 처리를 고려해서 설계된 언어라는 점이다.
